C51 COMPILER V9.55   ADC0809                                                               05/05/2020 21:03:31 PAGE 1   


C51 COMPILER V9.55, COMPILATION OF MODULE ADC0809
OBJECT MODULE PLACED IN .\Objects\ADC0809.obj
COMPILER INVOKED BY: d:\Keil_v5_all\C51\BIN\C51.EXE ADC0809.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listin
                    -gs\ADC0809.lst) OBJECT(.\Objects\ADC0809.obj)

line level    source

   1          #include "ADC0809.h"
   2          
   3          uchar AD_DATA[1]; 
   4          uchar light[3]={0,0,0};
   5          
   6          /**********************************************************************
   7          * 名称 : ADC0809();
   8          * 功能 : ADC0809把模拟量转化为八位数字量
   9          * 输入 : 无
  10          * 输出 : 无
  11          ***********************************************************************/
  12          void ADC0809()
  13          {
  14   1              
  15   1              OE=0;            //初始化高阻态    转化初始化   低电平，禁止输出允许
  16   1      
  17   1              ST=0;
  18   1              ST=1;            //上升沿 清零    
  19   1      
  20   1              ST=0;            //下降沿 开始转换
  21   1              
  22   1              while(EOC==0);                      //外部中断 等待AD转换结束   EOC为1时AD转换结束跳出
  23   1              
  24   1              OE=1;                                           //高电平，输出允许
  25   1              AD_DATA[0]=adc0809_data;        //读取AD数据，数据范围为0-255
  26   1      
  27   1              OE=0;                                           //低电平，禁止输出允许
  28   1      }
  29          
  30          void Read_Light()
  31          {
  32   1              long T;
  33   1              ADC0809();                                  //将读出的ad0809数值放入AD_DATA     
  34   1              T=(AD_DATA[0])*48600/255;   //5V电压分为255份
  35   1              light[0]='0'+T/10000;
  36   1              light[1]='0'+T%10000/1000;
  37   1              light[2]='0'+T%10000%1000/100;
  38   1      }
  39          
  40          void startT0()
  41          {
  42   1              EA=1; //开总中断
  43   1          TMOD=0x22; //设定定时器 T0工作方式
  44   1          TH0=216; //利用T0中断产生CLK信号
  45   1          TL0=216;  
  46   1          TR0=1; //启动定时器T0 
  47   1          ET0=1;
  48   1              
  49   1          ST=0; 
  50   1          OE=0; 
  51   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
C51 COMPILER V9.55   ADC0809                                                               05/05/2020 21:03:31 PAGE 2   

   CODE SIZE        =    189    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
